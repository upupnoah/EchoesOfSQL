# 表：怎么创建和修改数据表？

# 创建数据表

```sql
CREATE TABLE <表名>
(
字段名1 数据类型 [字段级别约束] [默认值]，
字段名2 数据类型 [字段级别约束] [默认值]，
......
[表级别约束]
);
```

## 创建流程

![https://static001.geekbang.org/resource/image/83/ff/83c593cb7679ed5f99c29d937712c8ff.jpg?wh=3883*1057](https://static001.geekbang.org/resource/image/83/ff/83c593cb7679ed5f99c29d937712c8ff.jpg?wh=3883*1057)

```sql
CREATE TABLE
    demo.importhead (
        listnumber INT,
        supplierid INT,
        stocknumber INT,
        --我们在字段importype定义为INT类型的后面，按照MySQL创建表的语法，加了默认值1。
        importtype INT DEFAULT 1,
        quantity DECIMAL(10, 3),
        importvalue DECIMAL(10, 2),
        recorder INT,
        recordingdate DATETIME
    );
```

- 插入数据
    
    ```sql
    INSERT INTO
        demo.importhead (
            listnumber,
            supplierid,
            stocknumber,
            -- 这里我们没有插入字段importtype的值
            quantity,
            importvalue,
            recorder,
            recordingdate
        )
    VALUES (
            3456,
            1,
            1,
            10,
            100,
            1,
            '2020-12-10'
        );
    ```
    

## 注意事项

- 字段名称要避开[系统关键字](https://dev.mysql.com/doc/refman/8.0/en/keywords.html#keywords-removed-in-current-series)

# 约束

## 默认约束

- 给字段设置默认值
- 例如上方的 `importtype INT DEFAULT 1`

## 非空约束

- 非空约束表示字段值不能为空，如果创建表的时候，指明某个字段非空，那么添加数据的时候，这个字段必须有值，否则系统就会提示错误
- `NOT NULL`

## 唯一性约束

- 唯一性约束表示这个字段的值不能重复，否则系统会提示错误。跟主键约束相比，唯一性约束要更加弱一些
- **满足主键约束的字段，自动满足非空约束，但是满足唯一性约束的字段，可以是空值**
- `UNIQUE (column1)`

## 自增约束

- 自增约束可以让 MySQL 自动给字段赋值，且保证不会重复，非常有用，只是不容易用好
- 在数据表中，只有整数类型的字段（包括 TINYINT、SMALLINT、MEDIUMINT、INT 和 BIGINT），才可以定义自增约束。自增约束的字段，每增加一条数据，值自动增加 1
- **可以给自增约束的字段赋值**，这个时候，MySQL 会**重置自增约束字段的自增基数**，下次添加数据的时候，**自动以自增约束字段的最大值加 1 为新的字段值**

# 修改数据表

复制表结构

```sql
CREATE TABLE demo.importheadhist
LIKE demo.importhead;
```

## 添加字段

```sql
mysql> ALTER TABLE demo.importheadhist
    -> ADD confirmer INT; -- 添加一个字段confirmer，类型INT
Query OK, 0 rows affected (0.04 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> ALTER TABLE demo.importheadhist
    -> ADD confirmdate DATETIME; -- 添加一个字段confirmdate，类型是DATETIME
Query OK, 0 rows affected (0.04 sec)
Records: 0  Duplicates: 0  Warnings: 0
```

## 修改字段

- 改字段名+类型
    
    ```sql
    mysql> ALTER TABLE demo.importheadhist
        -> CHANGE quantity importquantity DOUBLE;
    Query OK, 0 rows affected (0.15 sec)
    Records: 0  Duplicates: 0  Warnings: 0
    ```
    
- 只改类型
    
    ```sql
    ALTER TABLE demo.importheadhist
    MODIFY importquantity DECIMAL(10,3);
    ```
    
- 表中添加一个字段
    
    ```sql
    ALTER TABLE demo.importheadhist
    ADD suppliername TEXT AFTER supplierid;
    ```
    

# 总结

```sql
CREATE TABLE
(
字段名 字段类型 PRIMARY KEY
);
CREATE TABLE
(
字段名 字段类型 NOT NULL
);
CREATE TABLE
(
字段名 字段类型 UNIQUE
);
CREATE TABLE
(
字段名 字段类型 DEFAULT 值
);
-- 这里要注意自增类型的条件，字段类型必须是整数类型。
CREATE TABLE
(
字段名 字段类型 AUTO_INCREMENT
);
-- 在一个已经存在的表基础上，创建一个新表
CREATE TABLE demo.importheadhist LIKE demo.importhead;
-- 修改表的相关语句
ALTER TABLE 表名 CHANGE 旧字段名 新字段名 数据类型;
ALTER TABLE 表名 ADD COLUMN 字段名 字段类型 FIRST|AFTER 字段名;
ALTER TABLE 表名 MODIFY 字段名 字段类型 FIRST|AFTER 字段名;
```